function getPageScroll(){var e;return self.pageYOffset?e=self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),arrayPageScroll=new Array("",e),arrayPageScroll}function getPageSize(){var e,t;window.innerHeight&&window.scrollMaxY?(e=document.body.scrollWidth,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(e=document.body.scrollWidth,t=document.body.scrollHeight):(e=document.body.offsetWidth,t=document.body.offsetHeight);var i,n;return self.innerHeight?(i=self.innerWidth,n=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(i=document.documentElement.clientWidth,n=document.documentElement.clientHeight):document.body&&(i=document.body.clientWidth,n=document.body.clientHeight),n>t?pageHeight=n:pageHeight=t,i>e?pageWidth=i:pageWidth=e,arrayPageSize=new Array(pageWidth,pageHeight,i,n),arrayPageSize}function pause(e){for(var t=new Date,i=t.getTime()+e;;)if(t=new Date,t.getTime()>i)return}function getKey(e){null==e?keycode=event.keyCode:keycode=e.which,key=String.fromCharCode(keycode).toLowerCase(),("x"==key||"q"==key)&&hideLightbox()}function listenKey(){document.onkeypress=getKey}function showLightbox(e){var t=document.getElementById("overlay"),n=document.getElementById("lightbox"),o=document.getElementById("lightboxCaption"),l=document.getElementById("lightboxImage"),d=document.getElementById("loadingImage"),a=document.getElementById("lightboxDetails"),r=getPageSize(),s=getPageScroll();d&&(d.style.top=s[1]+(r[3]-35-d.height)/2+"px",d.style.left=(r[0]-20-d.width)/2+"px",d.style.display="block"),t.style.height=r[1]+"px",t.style.display="block",imgPreload=new Image,imgPreload.onload=function(){l.src=e.href;var c=s[1]+(r[3]-35-imgPreload.height)/2,g=(r[0]-20-imgPreload.width)/2;for(n.style.top=0>c?"0px":c+"px",n.style.left=0>g?"0px":g+"px",a.style.width=imgPreload.width+"px",e.getAttribute("title")?(o.style.display="block",o.innerHTML=e.getAttribute("title")):o.style.display="none",-1!=navigator.appVersion.indexOf("MSIE")&&pause(250),d&&(d.style.display="none"),selects=document.getElementsByTagName("select"),i=0;i!=selects.length;i++)selects[i].style.visibility="hidden";return n.style.display="block",r=getPageSize(),t.style.height=r[1]+"px",listenKey(),!1},imgPreload.src=e.href}function hideLightbox(){for(objOverlay=document.getElementById("overlay"),objLightbox=document.getElementById("lightbox"),objOverlay.style.display="none",objLightbox.style.display="none",selects=document.getElementsByTagName("select"),i=0;i!=selects.length;i++)selects[i].style.visibility="visible";document.onkeypress=""}function initLightbox(){if(document.getElementsByTagName){for(var e=document.getElementsByTagName("a"),t=0;t<e.length;t++){var i=e[t];i.getAttribute("href")&&"lightbox"==i.getAttribute("rel")&&(i.onclick=function(){return showLightbox(this),!1})}var n=document.getElementsByTagName("body").item(0),o=document.createElement("div");o.setAttribute("id","overlay"),o.onclick=function(){return hideLightbox(),!1},o.style.display="none",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.zIndex="90",o.style.width="100%",n.insertBefore(o,n.firstChild);var a=(getPageSize(),getPageScroll(),new Image);a.onload=function(){var e=document.createElement("a");e.setAttribute("href","#"),e.onclick=function(){return hideLightbox(),!1},o.appendChild(e);var t=document.createElement("img");return t.src=loadingImage,t.setAttribute("id","loadingImage"),t.style.position="absolute",t.style.zIndex="150",e.appendChild(t),a.onload=function(){},!1},a.src=loadingImage;var r=document.createElement("div");r.setAttribute("id","lightbox"),r.style.display="none",r.style.position="absolute",r.style.zIndex="100",n.insertBefore(r,o.nextSibling);var s=document.createElement("a");s.setAttribute("href","#"),s.setAttribute("title","Click to close"),s.onclick=function(){return hideLightbox(),!1},r.appendChild(s);var c=document.createElement("img");c.setAttribute("id","lightboxImage"),s.appendChild(c);var g=document.createElement("div");g.setAttribute("id","lightboxDetails"),r.appendChild(g);var m=document.createElement("div");m.setAttribute("id","lightboxCaption"),m.style.display="none",g.appendChild(m);var u=document.createElement("div");u.setAttribute("id","keyboardMsg");var y="";y+='<a href="#" onclick="hideLightbox(); return false;"> Close </a>',u.innerHTML=y,g.appendChild(u)}}function addLoadEvent(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t(),e()}}var loadingImage="lightbox/loading.gif";addLoadEvent(initLightbox);